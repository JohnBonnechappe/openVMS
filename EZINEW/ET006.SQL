MODULE		EZITRAK06_SQL
LANGUAGE	COBOL
AUTHORIZATION	ET_DB1
DECLARE EXTERNAL ET_DB1 SCHEMA AUTHORIZATION FOR FILENAME EZITRAK_DATABASE

DECLARE APPLICATION_DETAILS_C CURSOR FOR
		SELECT	APPLICATION_ID
		     ,  APPLICATION_DESC
                     ,  REC_USER
                     ,  REC_TMSTAMP
		FROM   APPLICATION_DETAILS
		WHERE  APPLICATION_ID    >= W010_APPLICATION_ID
		ORDER BY APPLICATION_ID

PROCEDURE ET_OC_APPLICATION_DETAILS
	SQLCA
               W010_APPLICATION_ID           CHAR(3)
        ;
        OPEN APPLICATION_DETAILS_C
	;

PROCEDURE ET_FC_APPLICATION_DETAILS
	SQLCA
               W010_APPLICATION_ID           CHAR(3)
               W010_APPLICATION_DESC         CHAR(25)
               W010_REC_USER            CHAR(8)
               W010_REC_TMSTAMP         DATE
        ;
        FETCH APPLICATION_DETAILS_C
	INTO   W010_APPLICATION_ID
           ,   W010_APPLICATION_DESC
           ,   W010_REC_USER
           ,   W010_REC_TMSTAMP
	;

PROCEDURE ET_CC_APPLICATION_DETAILS
	SQLCA
	;
        CLOSE APPLICATION_DETAILS_C
	;

PROCEDURE ET_IR_APPLICATION_DETAILS
	SQLCA
               W010_APPLICATION_ID            CHAR(3)
               W010_APPLICATION_DESC          CHAR(25)
               W010_REC_USER             CHAR(8)
               W010_REC_TMSTAMP          DATE
	;
		INSERT	INTO APPLICATION_DETAILS
		VALUES
               (W010_APPLICATION_ID
               ,W010_APPLICATION_DESC
               ,W010_REC_USER
               ,W010_REC_TMSTAMP
		     )
	;

PROCEDURE ET_UR_APPLICATION_DETAILS
	SQLCA
               W010_APPLICATION_ID            CHAR(3)
               W010_APPLICATION_DESC          CHAR(25)
               W010_REC_USER             CHAR(8)
               W010_REC_TMSTAMP          DATE
	;
		UPDATE APPLICATION_DETAILS
	          SET   APPLICATION_DESC          = W010_APPLICATION_DESC
		     ,	REC_USER             = W010_REC_USER
		     ,	REC_TMSTAMP          = W010_REC_TMSTAMP
		WHERE APPLICATION_ID              = W010_APPLICATION_ID
	;

PROCEDURE ET_DR_APPLICATION_DETAILS
	SQLCA
	W010_APPLICATION_ID   	          CHAR(3)
	;
		DELETE	FROM APPLICATION_DETAILS
			WHERE APPLICATION_ID	 = W010_APPLICATION_ID
	;

PROCEDURE ET_SS_APPLICATION_DETAILS
	SQLCA
               W010_APPLICATION_ID           CHAR(3)
               W010_APPLICATION_DESC         CHAR(25)
               W010_REC_USER             CHAR(8)
               W010_REC_TMSTAMP          DATE
	;
		SELECT	APPLICATION_DESC
                     ,  REC_USER
                     ,  REC_TMSTAMP
	INTO    W010_APPLICATION_DESC
              , W010_REC_USER
              , W010_REC_TMSTAMP
		FROM   APPLICATION_DETAILS
		WHERE  APPLICATION_ID    = W010_APPLICATION_ID
	;

PROCEDURE ET_ST_RO_APPLICATION
		SQLCA
	;
		SET TRANSACTION
			READ ONLY
			RESERVING ET_DB1.APPLICATION_DETAILS   FOR SHARED READ
	;

PROCEDURE ET_ST_RW_APPLICATION
	SQLCA
	;
		SET TRANSACTION
			READ WRITE
			RESERVING ET_DB1.APPLICATION_DETAILS FOR SHARED WRITE
	;

PROCEDURE ET_CMT_TRN
	SQLCA
	;
		COMMIT
	;

PROCEDURE ET_RLB_TRN
	SQLCA
	;
		ROLLBACK
	;

-- ************ end of module *************************
